---
title: "Lab 11 - Smoking during pregnancy"
author: "Conor Lacey"
date: "03/27/2023"
output: github_document
---

### Load packages and data

```{r load-packages, message=FALSE}
suppressWarnings(library(tidyverse)) 
suppressWarnings(library(openintro))
suppressWarnings(library(skimr))
suppressWarnings(library(Hmisc))
suppressWarnings(library(infer))
```

### Exercise 1

```{r ncbirths data}
set.seed(4215)
data("ncbirths")

skim(ncbirths)

ncbirths_num <- ncbirths %>% select_if(is.numeric)
hist.data.frame(ncbirths_num)
```

Variables mature, premie, marital, lowbirthweight, gender, habit, and whitemom are categorical. 

Variables fage, mage, weeks, visits, gained, and weight are numerical. 

It also appears from the histograms that visits and weeks have some outliers.

### Exercise 2

```{r ncbirths_white}
ncbirths_white <- ncbirths %>% filter(whitemom == "white")
mean(ncbirths_white$weight)
```

### Exercise 3 

I believe so. We are wanting to know whether the average weight of Caucasian babies has changed since 1995. However, we only have a sample of data, but we can use this sample to *infer* what is happening in the population. We can also resample from this multiple times and do a bootstap (a simulation) to make this inference.

```{r bootstrap}
avg<-c(NA)
for (i in 1:1000){
x <- sample(ncbirths_white$weight, size = 50, replace = TRUE)
avg[i]<-mean(x)
}
df_weight <- data.frame(avg = avg)
df_weight <- df_weight %>% mutate(avg =(avg + (7.43-mean(ncbirths_white$weight))))

df_weight %>% ggplot(aes(x = avg)) +
  geom_histogram(color = "black",fill = "blue", alpha = 0.4) +
  xlab("weight")

sum((df_weight$avg <= (mean(ncbirths_white$weight))) / length(df_weight$avg)) +
sum((df_weight$avg >= (7.43+(7.43-mean(ncbirths_white$weight)))) / length(df_weight$avg))
```

### Exercise 4 

For a two-tailed test we would get a p-value of 0.37. This is given by that the probability of getting a difference between the null and observed value in the negative direction is .183 and the probability of getting a difference between the null and observed value in the positive direction is .187.

This p-value indicates that there has not been a significant change in the average birth weight of Caucasian babies since 1995.

### Exercise 5

```{r weight and habit}
ncbirths %>% na.omit(cols = "habit") %>% ggplot(aes(y = weight, color = habit)) +
  geom_boxplot()
```

Individuals whose mothers smoke tend to have lower birth weights.

### Exercise 6 
```{r}
ncbirths_habitgiven <- ncbirths %>% na.omit(cols = "habit")

ncbirths_habitgiven %>%
  group_by(habit) %>%
  summarise(mean_weight = mean(weight))
```

### Exercise 7 

H0: mu_weight_smoke = mu_weight_!smoke

H1: mu_weight_smoke â‰  mu_weight_!smoke

### Exercise 8

---
title: "Lab 11 - Smoking during pregnancy"
author: "Conor Lacey"
date: "03/27/2023"
output: github_document
---

### Load packages and data

```{r load-packages, message=FALSE}
suppressWarnings(library(tidyverse)) 
suppressWarnings(library(openintro))
suppressWarnings(library(skimr))
suppressWarnings(library(Hmisc))
suppressWarnings(library(infer))
```

### Exercise 1

```{r ncbirths data}
set.seed(4215)
data("ncbirths")

skim(ncbirths)

ncbirths_num <- ncbirths %>% select_if(is.numeric)
hist.data.frame(ncbirths_num)
```

Variables mature, premie, marital, lowbirthweight, gender, habit, and whitemom are categorical. 

Variables fage, mage, weeks, visits, gained, and weight are numerical. 

It also appears from the histograms that visits and weeks have some outliers.

### Exercise 2

```{r ncbirths_white}
ncbirths_white <- ncbirths %>% filter(whitemom == "white")
mean(ncbirths_white$weight)
```

### Exercise 3 

I believe so. We are wanting to know whether the average weight of Caucasian babies has changed since 1995. However, we only have a sample of data, but we can use this sample to *infer* what is happening in the population. We can also resample from this multiple times and do a bootstap (a simulation) to make this inference.

```{r bootstrap}
boot_df_weight <- ncbirths_white %>%
  specify(response = weight) %>% 
  generate(reps = 1000, type = "bootstrap") %>% 
  calculate(stat = "mean")

boot_df_weight <- boot_df_weight %>% mutate(stat = (stat + (7.43-mean(ncbirths_white$weight))))

boot_df_weight %>% ggplot(aes(x = stat)) +
  geom_histogram(color = "black",fill = "blue", alpha = 0.4) +
  xlab("weight")

sum((boot_df_weight$stat <= (mean(ncbirths_white$weight))) / length(boot_df_weight$stat)) +
sum((boot_df_weight$stat >= (7.43+(7.43-mean(ncbirths_white$weight)))) / length(boot_df_weight$stat))
```

### Exercise 4 

For a two-tailed test we would get a p-value of 0. In other words, there are 0 instances of having a sample mean that is at least as extreme as the observed sample mean.

This p-value indicates that there has been a significant change in the average birth weight of Caucasian babies since 1995.

### Exercise 5

```{r weight and habit}
ncbirths %>% na.omit(cols = "habit") %>% ggplot(aes(y = weight, color = habit)) +
  geom_boxplot()
```

Individuals whose mothers smoke tend to have lower birth weights.

### Exercise 6 
```{r}
ncbirths_habitgiven <- ncbirths %>% na.omit(cols = "habit")

ncbirths_habitgiven %>%
  group_by(habit) %>%
  summarise(mean_weight = mean(weight))
```

### Exercise 7 

H0: mu_weight_smoke = mu_weight_!smoke

H1: mu_weight_smoke â‰  mu_weight_!smoke

### Exercise 8

Yes. We do not know the true population difference in birth weight of babies' mothers who smoked and didn't smoke. We do have a sample however, and can make an *inference* as to whether a difference exists in the population. 

### Exercise 9

```{r hypothesis test}
#smoker
boot_df_smoker <- ncbirths_habitgiven %>% 
  filter(habit == "smoker") %>%
  specify(response = weight) %>% 
  generate(reps = 1000, type = "bootstrap") %>% 
  calculate(stat = "mean")

#nonsmoker
boot_df_nonsmoker <- ncbirths_habitgiven %>% 
  filter(habit == "nonsmoker") %>%
  specify(response = weight) %>% 
  generate(reps = 1000, type = "bootstrap") %>% 
  calculate(stat = "mean")

boot_df_diff <- (boot_df_nonsmoker$stat-boot_df_smoker$stat) %>% 
  as.data.frame() %>% 
  setNames("MeanDiff")

boot_df_diff_c <- (boot_df_diff$MeanDiff - mean(boot_df_diff$MeanDiff)) %>% 
  as.data.frame() %>% 
  setNames("MeanDiff")

sum((boot_df_diff_c$MeanDiff >= mean(boot_df_diff$MeanDiff))/length(boot_df_diff_c$MeanDiff)) +
sum((boot_df_diff_c$MeanDiff <= (mean(boot_df_diff$MeanDiff)*-1))/length(boot_df_diff_c$MeanDiff))
```

The p-value is 0.021. There is evidence to show that there is a difference in birth weight of babies whose mothers smokes versus don't smoke. 

